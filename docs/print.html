<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Geoprox Manual</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="chapter_1.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="chapter_2.html"><strong aria-hidden="true">2.</strong> How Geoprox Works</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="chapter_2_1.html"><strong aria-hidden="true">2.1.</strong> What is a Geohash?</a></li><li class="chapter-item expanded "><a href="chapter_2_2.html"><strong aria-hidden="true">2.2.</strong> Prefix Searching</a></li><li class="chapter-item expanded "><a href="chapter_2_3.html"><strong aria-hidden="true">2.3.</strong> Insertion and Query</a></li></ol></li><li class="chapter-item expanded "><a href="chapter_3.html"><strong aria-hidden="true">3.</strong> Getting Started</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="chapter_3_1.html"><strong aria-hidden="true">3.1.</strong> Configuration</a></li><li class="chapter-item expanded "><a href="chapter_3_2.html"><strong aria-hidden="true">3.2.</strong> Docker Guide</a></li><li class="chapter-item expanded "><a href="chapter_3_3.html"><strong aria-hidden="true">3.3.</strong> Client SDK</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Geoprox Manual</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="introduction"><a class="header" href="#introduction">Introduction</a></h1>
<p><a href="https://github.com/ezrasingh/geoprox/">Geoprox</a> is a geospatial indexing and querying API designed to simplify and optimize location-based operations.</p>
<p>It provides efficient methods for encoding and decoding geohashes, finding neighboring regions, and managing geospatial indexes for a variety of applications such as food delivery services and real-time inventory tracking.</p>
<h2 id="key-features"><a class="header" href="#key-features">Key Features:</a></h2>
<ul>
<li><strong>Geohash Encoding and Decoding</strong>: Convert geographic coordinates into geohashes and retrieve coordinates from geohashes for easy location-based operations.</li>
<li><strong>Neighbor Identification</strong>: Quickly find neighboring geohashes to support spatial queries and region-based operations.</li>
<li><strong>Geospatial Index Management</strong>: Create, update, and delete geospatial indexes to organize and query location-based data efficiently.</li>
<li><strong>Proximity Searches</strong>: Perform radius-based searches to locate nearby resources or inventory items.</li>
</ul>
<h2 id="benefits"><a class="header" href="#benefits">Benefits:</a></h2>
<ul>
<li><strong>Efficient Spatial Data Handling</strong>: Streamline operations by leveraging geohashes for compact and hierarchical representation of locations.</li>
<li><strong>Flexible Querying</strong>: Use proximity-based queries to enhance real-time decision-making and operational efficiency.</li>
<li><strong>Easy Integration</strong>: Seamlessly integrate Geoprox with applications for real-time tracking, delivery services, and more.</li>
</ul>
<h2 id="contributing"><a class="header" href="#contributing">Contributing</a></h2>
<p>Geoprox is an open-source project and welcomes contributions from the community. If you’d like to contribute, please visit the <a href="https://github.com/ezrasingh/geoprox/">GitHub repository</a> to find the source code, report issues, and submit feature requests. For detailed guidance on contributing, please refer to the CONTRIBUTING document.</p>
<h2 id="license"><a class="header" href="#license">License</a></h2>
<p>Geoprox is licensed under the <a href="https://github.com/ezrasingh/geoprox/blob/main/LICENSE-APACHE">Apache 2.0</a> or <a href="https://github.com/ezrasingh/geoprox/blob/main/LICENSE-MIT">MIT License</a> (your choice).</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="how-geoprox-works"><a class="header" href="#how-geoprox-works">How Geoprox Works</a></h1>
<h2 id="the-problem"><a class="header" href="#the-problem">The Problem</a></h2>
<p>Initially, for the <a href="https://gitlab.com/indyrs/may2024/-/blob/main/Geo-Proximity-Detection-With-Rust.pdf">May 2024 Rust Indy.rs meetup</a>, the proof of concept problem began with ride-share pairing like Uber or Lyft.</p>
<p>Ride pairing depends on being able to track and pair a set of drivers within the vicinity of some location (i.e., the pickup location of an order).</p>
<p>Since then, the problem has generalized to how can we efficiently track and retrieve resources geographically near some location.</p>
<h2 id="objectives"><a class="header" href="#objectives">Objectives</a></h2>
<ul>
<li>Keep track of the <em>approximate</em> location of objects.</li>
<li>Search should return a set of objects within a radius of the search location.</li>
</ul>
<h2 id="solution"><a class="header" href="#solution">Solution</a></h2>
<p>Index the objects and hash their key and geographical position. Using a <a href="https://en.wikipedia.org/wiki/Geohash">geohash</a> to encode the approximate location, we can map geohash prefixes into the set of objects contained in the geohash using a <a href="https://en.wikipedia.org/wiki/Trie">Prefix Tree</a> stored in-memory.</p>
<p>We can efficiently partition the search space and perform a <a href="https://en.wikipedia.org/wiki/Nearest_neighbour_algorithm">nearest neighbor search</a> on a merged set of objects in the search region and return the results.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="what-is-a-geohash"><a class="header" href="#what-is-a-geohash">What is a Geohash?</a></h1>
<p>A geohash is a string representation of a geographic location, encoded as a series of characters. This encoding allows for efficient storage and querying of spatial data. Geohashes are hierarchical, meaning that as the string length increases, the represented area becomes more precise.</p>
<h2 id="how-geohashes-work"><a class="header" href="#how-geohashes-work">How Geohashes Work</a></h2>
<p><img src="assets/geohash-levels.png" alt="" /></p>
<p>Geohashes divide the world into a grid of cells, each with a unique identifier (encoded in base 32). The precision of the geohash can be adjusted by changing its length:</p>
<ul>
<li>Short geohashes represent larger areas.</li>
<li>Long geohashes represent smaller, more precise areas.</li>
</ul>
<div class="table-wrapper"><table><thead><tr><th>Geohash Length</th><th>Lat Bits</th><th>Lng Bits</th><th>Lat Error</th><th>Lng Error</th><th>Km Error</th></tr></thead><tbody>
<tr><td>1</td><td>2</td><td>3</td><td>±23</td><td>±23</td><td>±2,500 km (1,600 mi)</td></tr>
<tr><td>2</td><td>5</td><td>5</td><td>±2.8</td><td>±5.6</td><td>±630 km (390 mi)</td></tr>
<tr><td>3</td><td>7</td><td>8</td><td>±0.70</td><td>±0.70</td><td>±78 km (48 mi)</td></tr>
<tr><td>4</td><td>10</td><td>10</td><td>±0.087</td><td>±0.18</td><td>±20 km (12 mi)</td></tr>
<tr><td>5</td><td>12</td><td>13</td><td>±0.022</td><td>±0.022</td><td>±2.4 km (1.5 mi; 2,400 m)</td></tr>
<tr><td>6</td><td>15</td><td>15</td><td>±0.0027</td><td>±0.0055</td><td>±0.61 km (0.38 mi; 610 m)</td></tr>
<tr><td>7</td><td>17</td><td>18</td><td>±0.00068</td><td>±0.00068</td><td>±0.076 km (0.047 mi; 76 m)</td></tr>
<tr><td>8</td><td>20</td><td>20</td><td>±0.000085</td><td>±0.00017</td><td>±0.019 km (0.012 mi; 19 m)</td></tr>
</tbody></table>
</div>
<p>For example, the following geohashes are all within a maximum distance of +/- 78km (48mi) from each other:</p>
<ul>
<li><strong>s00</strong>8nb00j8</li>
<li><strong>s00</strong>twy01mt</li>
<li><strong>s00</strong>j8n012j</li>
</ul>
<p>However, these geohashes represent completely different regions:</p>
<ul>
<li><strong>s12</strong>8nb00j8</li>
<li><strong>s34</strong>twy01mt</li>
<li><strong>s56</strong>j8n012j</li>
</ul>
<h2 id="benefits-of-using-geohashes"><a class="header" href="#benefits-of-using-geohashes">Benefits of Using Geohashes</a></h2>
<ul>
<li><strong>Compact Representation</strong>: Efficiently stores geographic coordinates.</li>
<li><strong>Hierarchical Structure</strong>: Allows for easy aggregation and precision adjustment.</li>
<li><strong>Proximity Queries</strong>: Simplifies the process of finding nearby locations.</li>
</ul>
<blockquote>
<p>Check out the <a href="https://geohash.softeng.co/">Geohash Explorer</a> for an interactive map to help visualize geohashing.</p>
</blockquote>
<iframe
    src="https://geohash.softeng.co/"
    sandbox="allow-scripts"
    referrerpolicy="no-referrer"
    width="100%" height="500"
    style="border: none; display:none;"
    onload="this.style.display='inline';"
></iframe>
<div style="break-before: page; page-break-before: always;"></div><h1 id="prefix-searching"><a class="header" href="#prefix-searching">Prefix Searching</a></h1>
<h2 id="what-is-prefix-search"><a class="header" href="#what-is-prefix-search">What is Prefix Search?</a></h2>
<p>Prefix search is a method for quickly finding all entries in a dataset that share a common prefix. In the context of geohashes, it allows us to retrieve all geohashes that start with the same characters, which is useful for geographical proximity searches.</p>
<h2 id="trie-tree"><a class="header" href="#trie-tree">Trie Tree</a></h2>
<p><img src="assets/trie.png" alt="" /></p>
<p>We can store Geohashes in a <a href="https://en.wikipedia.org/wiki/Trie">Trie Tree</a> data structure. Tries enable us to efficiently retrieve geohashes with a common prefix in <code>O(L)</code> time, where <code>L</code> is the length of the prefix being searched.</p>
<h3 id="key-features-of-trie-tree"><a class="header" href="#key-features-of-trie-tree">Key Features of Trie Tree:</a></h3>
<ul>
<li><strong>Efficient Retrieval:</strong> Quickly find geohashes sharing a common prefix.</li>
<li><strong>Time Complexity:</strong> <code>O(L)</code>, where <code>L</code> is the prefix length.</li>
</ul>
<h2 id="patricia-trie"><a class="header" href="#patricia-trie">Patricia Trie</a></h2>
<p><img src="assets/patricia-trie.png" alt="" /></p>
<p>A <a href="https://en.wikipedia.org/wiki/Radix_tree#Variants">Patricia Trie</a>, also known as a <a href="https://en.wikipedia.org/wiki/Radix_tree">Radix Tree</a>, is a type of Trie Tree that optimizes space by merging common prefixes into single nodes. This further enhances the efficiency of prefix searching by reducing the number of nodes.</p>
<h3 id="key-features-of-patricia-trie-tree"><a class="header" href="#key-features-of-patricia-trie-tree">Key Features of Patricia Trie Tree:</a></h3>
<ul>
<li><strong>Space Optimization:</strong> Merges common prefixes to save space.</li>
<li><strong>Efficient Lookup:</strong> Retrieves geohashes with common prefixes efficiently.</li>
<li><strong>Time Complexity:</strong> Best case <code>O(log N)</code> where <code>N</code> is the length of the longest geohash stored, and worst case <code>O(L)</code> where <code>L</code> is the length of the prefix.</li>
</ul>
<h2 id="comparisons"><a class="header" href="#comparisons">Comparisons</a></h2>
<h3 id="skip-list"><a class="header" href="#skip-list">Skip List</a></h3>
<p>A <a href="https://en.wikipedia.org/wiki/Skip_list">Skip List</a> is a probabilistic data structure that allows for fast search, insertion, and deletion operations. It consists of multiple levels of linked lists, with each higher level acting as an "express lane" for elements lower down.</p>
<ul>
<li>
<p><strong>Pros:</strong></p>
<ul>
<li><strong>Efficient Average-case Performance:</strong> Provides good average-case performance for search operations, typically <code>O(log N)</code> time complexity.</li>
<li><strong>Cache-friendly:</strong> The contiguous arrangement of nodes makes Skip Lists more cache-friendly than tree-based structures.</li>
</ul>
</li>
<li>
<p><strong>Cons:</strong></p>
<ul>
<li><strong>Space Overhead:</strong> Requires additional space to maintain pointers for multiple levels, resulting in higher space usage compared to a Patricia Trie.</li>
<li><strong>Probability Calculations:</strong> Maintaining balance requires careful calculation of node levels' probabilities, involving some understanding of probability theory.</li>
</ul>
</li>
</ul>
<h3 id="b-trees-and-memtables"><a class="header" href="#b-trees-and-memtables">B-Trees and MemTables</a></h3>
<p><a href="https://en.wikipedia.org/wiki/B-tree">B-Trees</a> are balanced tree data structures that maintain sorted data and enable searches, sequential access, insertions, and deletions with logarithmic time complexity. <a href="https://www.mauriciopoppe.com/notes/computer-science/data-structures/memtable-sstable/">MemTables</a> are in-memory data structures used in conjunction with B-Trees to facilitate efficient storage and retrieval of key-value pairs before persisting data to disk.</p>
<ul>
<li>
<p><strong>Pros:</strong></p>
<ul>
<li><strong>Efficient Disk-based Storage:</strong> Ideal for managing large datasets and effective for disk-based storage solutions.</li>
<li><strong>Range Queries and Sorted Data Retrieval:</strong> Provides excellent performance for range queries and retrieving sorted data efficiently.</li>
</ul>
</li>
<li>
<p><strong>Cons:</strong></p>
<ul>
<li><strong>Memory Usage:</strong> MemTables require significant memory to store data before flushing to disk, which can be a limitation for very large datasets.</li>
<li><strong>Complexity in Merging:</strong> Managing and merging data between MemTables and disk-based storage can introduce complexity and overhead in maintaining data consistency.</li>
</ul>
</li>
</ul>
<h3 id="why-patricia-trie"><a class="header" href="#why-patricia-trie">Why Patricia Trie?</a></h3>
<p>For geospatial data, where object locations might change frequently, in-memory solutions like Patricia Trie are preferred. They offer superior speed and efficiency in managing dynamic data, avoiding the latency associated with disk I/O operations.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="insertion-and-query"><a class="header" href="#insertion-and-query">Insertion and Query</a></h1>
<p>This section outlines the fundamental design strategy behind Geoprox, detailing the algorithms used for inserting and querying geospatial data.</p>
<p>The core approach involves encoding geographic coordinates into geohashes, utilizing a <a href="https://en.wikipedia.org/wiki/Radix_tree#Variants">Patricia Trie</a> for efficient storage and retrieval, and employing a <a href="https://en.wikipedia.org/wiki/K-d_tree">KD-Tree</a> for fast <a href="https://en.wikipedia.org/wiki/Nearest_neighbor_search">nearest neighbor searches</a>. These techniques collectively enable Geoprox to efficiently manage and query large volumes of geospatial data.</p>
<h2 id="data-structures"><a class="header" href="#data-structures">Data Structures</a></h2>
<ul>
<li>
<p><strong>Approximate Position Tracking:</strong></p>
<ul>
<li>Utilize a <a href="https://doc.rust-lang.org/std/collections/struct.HashMap.html"><code>HashMap</code></a> (<a href="https://github.com/ezrasingh/geoprox/releases/tag/v0.3.0">* see v0.3.0 release notes</a>) to track approximate positions.</li>
<li>Format: <code>object_key</code> =&gt; <code>geohash(lat, lng)</code></li>
</ul>
</li>
<li>
<p><strong>Key/Value Storage:</strong></p>
<ul>
<li>Use <a href="https://docs.rs/patricia_tree/0.8.0/patricia_tree/map/type.StringPatriciaMap.html"><code>StringPatriciaMap</code></a> for efficient key/value storage.</li>
<li>Format: <code>geohash_region</code> =&gt; <code>HashSet(object_key)</code></li>
</ul>
</li>
</ul>
<h2 id="insert-procedure"><a class="header" href="#insert-procedure">Insert Procedure</a></h2>
<ol>
<li>
<p><strong>Hash Object's Latitude/Longitude:</strong></p>
<ul>
<li>Hash the object's latitude and longitude up to a certain depth (e.g., 6). This depth, called <code>insert_depth</code>, should be sufficient to ensure the resulting geohash region is large enough to store the density of objects in that area.</li>
</ul>
</li>
<li>
<p><strong>Upsert Object Key:</strong></p>
<ul>
<li>Insert or update the <code>object_key</code> in the <code>StringPatriciaMap</code> with its <code>geohash_region</code>.</li>
<li>If <code>object_key</code> had an existing <code>geohash_region</code>, remove its entry from that region in the <code>StringPatriciaMap</code>.</li>
</ul>
</li>
</ol>
<h2 id="search-procedure"><a class="header" href="#search-procedure">Search Procedure</a></h2>
<ol>
<li>
<p><strong>Initiate Search:</strong></p>
<ul>
<li>A search is initiated at a specific location with a given search range (in kilometers).</li>
</ul>
</li>
<li>
<p><strong>Encode Latitude/Longitude:</strong></p>
<ul>
<li>Encode the latitude and longitude into a geohash up to a specific depth (e.g., 6). This depth, called <code>search_depth</code>, should ensure the geohash region is small enough to fit within the search radius.</li>
</ul>
</li>
<li>
<p><strong>Optimize Geohash Search Region:</strong></p>
<ul>
<li>Optimize the geohash search region by expanding it until it covers the search area.</li>
<li>If the geohash search region does not contain the search radius, remove the last character (effectively expanding the region) until it fits within the search area.</li>
</ul>
</li>
<li>
<p><strong>Partition <code>StringPatriciaMap</code>:</strong></p>
<ul>
<li>Partition the <code>StringPatriciaMap</code> by the common prefix of the optimized geohash.</li>
</ul>
</li>
<li>
<p><strong>Construct <a href="https://docs.rs/kiddo/4.2.0/kiddo/type.KdTree.html"><code>KdTree</code></a>:</strong></p>
<ul>
<li>Iterate over the partition and construct a <code>KdTree</code>.</li>
<li>Store objects and their approximate locations in the <code>KdTree</code>.</li>
</ul>
</li>
<li>
<p><strong>Compute Nearest Neighbor:</strong></p>
<ul>
<li>Perform nearest neighbor computation with the search requirements against the <code>KdTree</code> to get the final result.</li>
</ul>
</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="getting-started"><a class="header" href="#getting-started">Getting Started</a></h1>
<p>Geoprox comes in different flavors depending on what you're cooking up. If you're looking to dive deep and use core features directly in your Rust projects, the <code>geoprox-core</code> crate is your go-to. It's packed with all the fundamental data structures that make Geoprox tick.</p>
<p>But if you're aiming for a more out-of-the-box experience, the main <code>geoprox</code> package is where the magic happens. It's the CLI runtime designed to sidecar with your other application services, making it super easy to integrate Geoprox into your existing setup.</p>
<h2 id="crates"><a class="header" href="#crates">Crates</a></h2>
<ul>
<li><a href="https://github.com/ezrasingh/geoprox/tree/main/geoprox/">geoprox</a> - Standalone CLI for running the Geoprox service</li>
<li><a href="https://github.com/ezrasingh/geoprox/tree/main/geoprox-core/">geoprox-core</a> - Core data structure implementations</li>
<li><a href="https://github.com/ezrasingh/geoprox/tree/main/geoprox-server/">geoprox-server</a> - HTTP API wrapper around <code>geoprox-core</code></li>
<li><a href="https://github.com/ezrasingh/geoprox/tree/main/contrib/client-sdk/rust/">geoprox-client</a> - HTTP client library for <code>geoprox-server</code></li>
</ul>
<h2 id="installation"><a class="header" href="#installation">Installation</a></h2>
<p>To install <code>geoprox</code>, use the following command:</p>
<pre><code class="language-sh">cargo install geoprox
</code></pre>
<h3 id="usage"><a class="header" href="#usage">Usage</a></h3>
<p>Geoprox provides several commands to start the server and work with geohashes:</p>
<pre><code class="language-sh">geoprox help
Usage: geoprox [COMMAND]

Commands:
  run     Start Geoprox server
  encode  Hash latitude/longitude into geohash
  decode  Decode geohash into approximate longitude/latitude
  spec    Generate an OpenAPI specification file
  help    Print this message or the help of the given subcommand(s)

Options:
  -h, --help     Print help
  -V, --version  Print version
</code></pre>
<p>To start using Geoprox, you can run the following command to start the server:</p>
<pre><code class="language-sh">geoprox run
</code></pre>
<p>You can also encode and decode geohashes directly from the CLI:</p>
<pre><code class="language-sh"># Encode latitude and longitude into geohash
geoprox encode --lat=37.7749 --lng=-122.4194 --depth=5

# Decode geohash into latitude and longitude
geoprox decode 9q8yy
</code></pre>
<p>For detailed help on any command, use the help command:</p>
<pre><code class="language-sh">geoprox help encode
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="configuration"><a class="header" href="#configuration">Configuration</a></h1>
<p>Geoprox <code>run</code> command allows specifying a configuration file using the <code>-c</code> or <code>--config</code> option or set the <code>GEOPROX_CONFIG</code> environment variable. This file can contain various settings to customize the behavior of the Geoprox server and commands. The configuration can be provided in any common format such as <code>YAML</code>, <code>TOML</code>, <code>JSON</code>, or <code>INI</code>.</p>
<h2 id="example-usage"><a class="header" href="#example-usage">Example Usage</a></h2>
<p>Specify config using <code>-c</code> flag:</p>
<pre><code class="language-sh"># from current working directory
geoprox run -c geoprox.toml

# from absolute path
geoprox run -c /my/custom/config.yaml
</code></pre>
<p>or using environment variables:</p>
<pre><code class="language-sh">export GEOPROX_CONFIG='/my/custom/config.json'

geoprox run
</code></pre>
<h2 id="example-config"><a class="header" href="#example-config">Example Config</a></h2>
<p>Here's an example configuration file in <code>TOML</code> format:</p>
<pre><code class="language-toml"># All settings are optional; these are the default values.
[server]
# The address the server will bind to
http_addr = '0.0.0.0'
# The port the server will listen on
http_port = 5000
# Request timeout
timeout = '10s'

[shard]
# Determines the default geohash length for inserts
insert_depth = 6
# Determines the default geohash length for searches
search_depth = 6
# Specifies the default number of results returned in range queries
default_count = 100
# Toggles the default sorting behavior for query results
default_sorted = false

[server.snapshots]
# Toggle snapshot usage
disabled = false
# Directory where snapshots will be stored
path = '/var/lib/geoprox/snapshots'
# How often snapshots will be taken
every = '30s'
</code></pre>
<h3 id="environment-variables"><a class="header" href="#environment-variables">Environment Variables</a></h3>
<p>These are the currently supported environment variables. They will take precedence over settings defined in the configuration file.</p>
<div class="table-wrapper"><table><thead><tr><th>Environment Variable</th><th>Description</th><th>Default Value</th></tr></thead><tbody>
<tr><td><code>GEOPROX_CONFIG</code></td><td>Specifies the configuration file path.</td><td></td></tr>
<tr><td><code>GEOPROX_HTTP_ADDR</code></td><td>The address the server will bind to.</td><td><code>0.0.0.0</code></td></tr>
<tr><td><code>GEOPROX_HTTP_PORT</code></td><td>The port the server will listen on.</td><td><code>5000</code></td></tr>
</tbody></table>
</div>
<h2 id="fine-tuning"><a class="header" href="#fine-tuning">Fine Tuning</a></h2>
<p>The <code>insert_depth</code> and <code>search_depth</code> settings control the precision of geohashing and impact the performance of distance calculations and search queries.</p>
<h3 id="optimizing-insert_depth"><a class="header" href="#optimizing-insert_depth">Optimizing <code>insert_depth</code></a></h3>
<p><strong>Higher Insert Depth:</strong></p>
<ul>
<li><strong>Description:</strong> Objects are grouped into smaller, more precise regions.</li>
<li><strong>Impact:</strong> Searching takes slightly longer, but distance calculations are more accurate.</li>
<li><strong>Use Case:</strong> Ideal for scenarios where precise distance measurements are crucial.</li>
</ul>
<p><strong>Lower Insert Depth:</strong></p>
<ul>
<li><strong>Description:</strong> Objects are grouped into larger regions.</li>
<li><strong>Impact:</strong> Search performance improves, but distance calculations become less accurate.</li>
<li><strong>Use Case:</strong> Best for cases where fast general distance estimates are acceptable.</li>
</ul>
<h3 id="optimizing-search_depth"><a class="header" href="#optimizing-search_depth">Optimizing <code>search_depth</code></a></h3>
<p><strong>Higher Search Depth:</strong></p>
<ul>
<li><strong>Description:</strong> The initial search region is smaller and more precise.</li>
<li><strong>Impact:</strong> Search queries take slightly longer, but results are more accurate.</li>
<li><strong>Use Case:</strong> Suitable for narrow range queries where high accuracy is needed.</li>
</ul>
<p><strong>Lower Search Depth:</strong></p>
<ul>
<li><strong>Description:</strong> The initial search region is larger, leading to faster searches.</li>
<li><strong>Impact:</strong> Search speed improves, but accuracy may be reduced.</li>
<li><strong>Use Case:</strong> Ideal for wide range queries where speed is prioritized over precision.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="docker-guide"><a class="header" href="#docker-guide">Docker Guide</a></h1>
<p>The Geoprox Docker image (<code>ezrasingh/geoprox</code>) is available on two registries:</p>
<ul>
<li><a href="https://hub.docker.com/repository/docker/ezrasingh/geoprox/">Docker Hub</a></li>
<li><a href="https://github.com/ezrasingh/geoprox/pkgs/container/geoprox">GitHub Container Registry</a></li>
</ul>
<h2 id="getting-started-1"><a class="header" href="#getting-started-1">Getting Started</a></h2>
<blockquote>
<p>To quickly get started with Docker Compose, skip to the <a href="chapter_3_2.html#quick-start">Quick Start Guide</a>.</p>
</blockquote>
<p>Pull the Geoprox container from one of the available repositories.</p>
<pre><code class="language-sh"># from Docker Hub
docker pull ezrasingh/geoprox:latest

# or from GitHub Container Registry
docker pull ghcr.io/ezrasingh/geoprox:latest
</code></pre>
<p>To run the container with default configurations, use:</p>
<pre><code class="language-sh">docker run -t -p 5000:5000 ezrasingh/geoprox:latest
</code></pre>
<p>This command will start the Geoprox container with the default settings, exposing port 5000 for access.</p>
<blockquote>
<p>To use another port on your machine try <code>-p &lt;my-port&gt;:5000</code></p>
</blockquote>
<h3 id="variants--tagging"><a class="header" href="#variants--tagging">Variants &amp; Tagging</a></h3>
<p>The Geoprox image supports two variant tags: <code>alpine</code> and <code>debian</code>.</p>
<p>By default, the <code>latest</code> tag uses the <code>alpine</code> variant. Latest is built from the <code>main</code> branch.</p>
<p>To pin your Geoprox instance to a specific version and variant, use the format <code>&lt;version&gt;-&lt;variant&gt;</code>, such as <code>v0.3.0-debian</code>.</p>
<blockquote>
<p>If you specify only the version, like <code>v0.3.0</code>, it will default to the <code>alpine</code> variant, resulting in <code>v0.3.0-alpine</code>.</p>
</blockquote>
<p>Check the respective registry for available tags.</p>
<h3 id="customizing-the-configuration"><a class="header" href="#customizing-the-configuration">Customizing the Configuration</a></h3>
<blockquote>
<p>For complete settings and configuration details, refer to the <a href="../../geoprox/README.html#configuration">Geoprox CLI README</a>.</p>
</blockquote>
<p>Geoprox allows specifying a configuration file using the <code>-c</code> or <code>--config</code> option or set the <code>GEOPROX_CONFIG</code> environment variable. Geoprox will automatically detect and parse configuration files in formats like <code>YAML</code>, <code>TOML</code>, <code>JSON</code>, or <code>INI</code> if they are named <code>geoprox.yaml</code>, <code>geoprox.toml</code>, <code>geoprox.json</code>, or <code>geoprox.ini</code>, respectively.</p>
<p>For example, if you have a configuration file named <code>geoprox.toml</code> in the container working directory (<code>/var/lib/geoprox</code>), you can run the container with the following command:</p>
<pre><code class="language-sh">docker run -t -p 5000:5000 \
    -v $(pwd)/geoprox.toml:/var/lib/geoprox/geoprox.toml:ro \
    ezrasingh/geoprox:latest \
    -c geoprox.toml
</code></pre>
<p>In this command:</p>
<ul>
<li><code>-v $(pwd)/custom-config.yaml:/some/path/custom-config.yaml:ro</code> mounts the local configuration file into the container.</li>
</ul>
<p>If you need to specify a different path or file name for your configuration, use the <code>-c</code> or <code>--config</code> option:</p>
<pre><code class="language-sh">docker run -t -p 5000:5000 \
    -v $(pwd)/custom-config.yaml:/some/path/custom-config.yaml:ro \
    ezrasingh/geoprox:latest \
    -c /some/path/custom-config.yaml
</code></pre>
<p>In this command:</p>
<ul>
<li><code>-c /some/path/custom-config.yaml</code> specifies the configuration file to be used by the Geoprox server.</li>
</ul>
<p>Or use the <code>GEOPROX_CONFIG</code> environment variable:</p>
<pre><code class="language-sh">docker run -t -p 5000:5000 \
    -v $(pwd)/custom-config.yaml:/some/path/custom-config.yaml:ro \
    -e GEOPROX_CONFIG='/some/path/custom-config.yaml' \
    ezrasingh/geoprox:latest
</code></pre>
<p>In this command:</p>
<ul>
<li><code>-e GEOPROX_CONFIG='/some/path/custom-config.yaml'</code> specifies the configuration file to be used by the Geoprox server.</li>
</ul>
<h2 id="quick-start"><a class="header" href="#quick-start">Quick Start</a></h2>
<p>To quickly get started with Geoprox using Docker, follow these steps to configure and run the server with Docker Compose.</p>
<blockquote>
<p>The provided Docker Compose configuration serves as a boilerplate to showcase how Geoprox can be configured and allows you to get an instance up and running fast for evaluation purposes.</p>
</blockquote>
<h3 id="docker-compose"><a class="header" href="#docker-compose">Docker Compose</a></h3>
<p>Use the following command to start the Geoprox service:</p>
<pre><code class="language-sh">docker-compose -f quickstart/docker-compose.yml up
</code></pre>
<p>This command will start the Geoprox service using the configuration specified in <a href="https://github.com/ezrasingh/geoprox/tree/main/contrib/docker/quickstart/docker-compose.yml"><code>quickstart/docker-compose.yml</code></a>. The <a href="https://github.com/ezrasingh/geoprox/tree/main/contrib/docker/quickstart/geoprox.toml">configuration file</a> in this setup is a basic example, allowing you to easily evaluate Geoprox with default settings.</p>
<p>For custom configurations, you can modify the Docker Compose file or replace it with your own configuration as needed.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="client-sdk"><a class="header" href="#client-sdk">Client SDK</a></h1>
<p>HTTP Client libraries are generated from an OpenAPI specification using <a href="https://github.com/OpenAPITools/openapi-generator/">OpenAPI Generator</a>.</p>
<h3 id="http-client-libraries"><a class="header" href="#http-client-libraries">HTTP Client Libraries</a></h3>
<p>Availble clients can be found at <a href="https://github.com/ezrasingh/geoprox/tree/main/contrib/client-sdk/"><code>contrib/client-sdk</code></a>, along with steps for generating your own client if needed.</p>
<div class="table-wrapper"><table><thead><tr><th>Language</th><th>Package Name</th><th>Repository Link</th></tr></thead><tbody>
<tr><td>C#</td><td><code>GeoproxClient</code></td><td><a href="https://github.com/ezrasingh/geoprox/contrib/client-sdk/csharp/">GeoproxClient</a></td></tr>
<tr><td>Dart</td><td><code>geoprox_client</code></td><td><a href="https://github.com/ezrasingh/geoprox/contrib/client-sdk/dart/">geoprox_client</a></td></tr>
<tr><td>Dart (Dio)</td><td><code>geoprox_client_dio</code></td><td><a href="https://github.com/ezrasingh/geoprox/contrib/client-sdk/dart-dio/">geoprox_client_dio</a></td></tr>
<tr><td>Elixir</td><td><code>geoprox_client</code></td><td><a href="https://github.com/ezrasingh/geoprox/contrib/client-sdk/elixir/">geoprox_client</a></td></tr>
<tr><td>Go</td><td><code>geoprox_client</code></td><td><a href="https://github.com/ezrasingh/geoprox/contrib/client-sdk/go/">geoprox_client</a></td></tr>
<tr><td>Groovy</td><td><code>geoprox-client-groovy</code></td><td><a href="https://github.com/ezrasingh/geoprox/contrib/client-sdk/groovy/">geoprox-client-groovy</a></td></tr>
<tr><td>Kotlin</td><td><code>geoprox_client</code></td><td><a href="https://github.com/ezrasingh/geoprox/contrib/client-sdk/kotlin/">geoprox_client</a></td></tr>
<tr><td>PHP</td><td><code>GeoproxClient</code></td><td><a href="https://github.com/ezrasingh/geoprox/contrib/client-sdk/php/">GeoproxClient</a></td></tr>
<tr><td>Python</td><td><code>geoprox_client</code></td><td><a href="https://github.com/ezrasingh/geoprox/contrib/client-sdk/python/">geoprox_client</a></td></tr>
<tr><td>Ruby</td><td><code>geoprox_client</code></td><td><a href="https://github.com/ezrasingh/geoprox/contrib/client-sdk/ruby/">geoprox_client</a></td></tr>
<tr><td>Rust</td><td><code>geoprox-client</code></td><td><a href="https://github.com/ezrasingh/geoprox/contrib/client-sdk/rust/">geoprox-client</a></td></tr>
<tr><td>TypeScript (Axios)</td><td><code>geoprox-client-ts-axios</code></td><td><a href="https://github.com/ezrasingh/geoprox/contrib/client-sdk/typescript-axios/">geoprox-client-ts-axios</a></td></tr>
<tr><td>TypeScript (Fetch)</td><td><code>geoprox-client-ts-fetch</code></td><td><a href="https://github.com/ezrasingh/geoprox/contrib/client-sdk/typescript-fetch/">geoprox-client-ts-fetch</a></td></tr>
<tr><td>TypeScript (Node)</td><td><code>geoprox-client-ts-node</code></td><td><a href="https://github.com/ezrasingh/geoprox/contrib/client-sdk/typescript-node/">geoprox-client-ts-node</a></td></tr>
<tr><td>TypeScript (RxJS)</td><td><code>geoprox-client-ts-rxjs</code></td><td><a href="https://github.com/ezrasingh/geoprox/contrib/client-sdk/typescript-rxjs/">geoprox-client-ts-rxjs</a></td></tr>
</tbody></table>
</div>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </div>
    </body>
</html>
